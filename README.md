# Yandex-Praktikum-Diplom - Foodgram-project-backend

Финальный учебный проект в рамках курса Яндекс.Практикум

![foodgram_workflow](https://github.com/ostenya/foodgram-project-react/actions/workflows/foodgram_workflow.yml/badge.svg)

## Описание
Цель данного проекта - создание приложения «Продуктовый помощник»: Python-бэкенда для сайта, на котором пользователи будут публиковать рецепты, добавлять чужие рецепты в избранное и подписываться на публикации других авторов. Сервис «Список покупок» позволит пользователям создавать список продуктов, которые нужно купить для приготовления выбранных блюд.

### Главная страница
Содержимое главной страницы — список первых шести рецептов, отсортированных по дате публикации (от новых к старым). Остальные рецепты доступны на следующих страницах: внизу страницы есть пагинация.

### Страница рецепта
На странице — полное описание рецепта. Для авторизованных пользователей — возможность добавить рецепт в избранное и в список покупок, возможность подписаться на автора рецепта.

### Страница пользователя
На странице — имя пользователя, все рецепты, опубликованные пользователем и возможность подписаться на пользователя.

### Подписка на авторов
Подписка на публикации доступна только авторизованному пользователю. Страница подписок доступна только владельцу.
Сценарий поведения пользователя:
1.	Пользователь переходит на страницу другого пользователя или на страницу рецепта и подписывается на публикации автора кликом по кнопке «Подписаться на автора».
2.	Пользователь переходит на страницу «Мои подписки» и просматривает список рецептов, опубликованных теми авторами, на которых он подписался. Сортировка записей — по дате публикации (от новых к старым).
3.	При необходимости пользователь может отказаться от подписки на автора: переходит на страницу автора или на страницу его рецепта и нажимает «Отписаться от автора».

### Список избранного
Работа со списком избранного доступна только авторизованному пользователю. Список избранного может просматривать только его владелец.
Сценарий поведения пользователя:
1.	Пользователь отмечает один или несколько рецептов кликом по кнопке «Добавить в избранное».
2.	Пользователь переходит на страницу «Список избранного» и просматривает персональный список избранных рецептов.
3.	При необходимости пользователь может удалить рецепт из избранного.

### Список покупок
Работа со списком покупок доступна авторизованным пользователям. Список покупок может просматривать только его владелец.
Сценарий поведения пользователя:
1.	Пользователь отмечает один или несколько рецептов кликом по кнопке «Добавить в покупки».
2.	Пользователь переходит на страницу Список покупок, там доступны все добавленные в список рецепты. Пользователь нажимает кнопку Скачать список и получает файл с суммированным перечнем и количеством необходимых ингредиентов для всех рецептов, сохранённых в «Списке покупок».
3.	При необходимости пользователь может удалить рецепт из списка покупок.
Список покупок скачивается в формате .csv.


## Технологии разработки
- Язык: Python 3.9.6
- Фреймворк: Django 4.0.5
- API: Djangorestframework 3.13.1
- Аутентификация по токену: Djoser - Token Based Authentication
- Документация: redoc
- Хранение ключей: файл .env (пример заполнения ниже)

## Технологии запуска
- Разворачивание: Docker-compose, Dockerfile + entrypoint.sh
- Веб-сервер: nginx:1.21.3-alpine
- Сервер приложения: gunicorn 20.1.0
- Сервер базы данных: postgres:13.0-alpine
- Workflow: GitHub Actions

## Инструкции по подготовке сервера
- Установите Docker на сервере (инструкции [здесь](https://docs.docker.com/engine/install/))
- Установите Docker-compose на сервере (инструкции [здесь](https://docs.docker.com/compose/install/))
- Для клонирования данного репозитория на локальный сервер выполните:
```
git clone https://github.com/Ostenya/foodgram-project-react.git
```
- Скопируйте файлы docker-compose.yaml и nginx/default.conf из вашего проекта на сервер в home/<ваш_username>
```scp docker-compose.yaml nginx.conf <ваш_username>@<ваш_IP_сервера>:/home/<ваш_username>

```
- В корневом каталоге создайте файл .env
шаблон наполнения env-файла:
```
SECRET_KEY= # указываем соответствующее значение (можно узнать у автора бэкенда - см. ниже)
DEBUG=False # выключаем режим разработчика

DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
POSTGRES_DB=foodgram # имя базы данных
DB_NAME=foodgram # имя базы данных
POSTGRES_USER=foodgram_user # логин для подключения к базе данных
POSTGRES_PASSWORD=foodgram12345 # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT=5432 # порт для подключения к БД
```

## Инструкции по запуску

- Запустите docker-compose (-d - запуск в фоновом режиме)
```
docker-compose up -d
```
- Для выполнения миграции выполните (Опционально - выполнение предусмотрено при запуске docker-compose через entrypoint.sh):
```
docker-compose exec backend python manage.py migrate
```
- Для сбора статики выполните (Опционально - выполнение предусмотрено при запуске docker-compose через entrypoint.sh):
```
docker-compose exec backend python manage.py collectstatic --no-input
```
- Создайте суперпользователя
```
docker-compose exec backend python manage.py createsuperuser
```
- Для заполнения базы тестовыми данными выполните:
```
docker-compose exec backend python manage.py load_ingredients
```
- Мониторинг запущенных контейнеров:
```
docker stats
```
- Запуск сервера в браузере:
http://localhost/
- Документация API:
http://localhost/api/docs/
- Интерфейс администратора:
http://localhost/admin/
- Для остановки контейнеров:
```
docker-compose down -v
```

## Авторы кода

Backend - [Ostenya](https://github.com/Ostenya)
Frontend - [Yandex-Practicum](https://github.com/Yandex-Practicum)
